<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø®Ø±ÙŠØ·Ø© ÙÙ„Ø³Ø·ÙŠÙ† Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ©</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        body {
            text-align: center;
            font-family: Arial, sans-serif;
        }
        #map-container {
            position: relative;
            display: inline-block;
        }
        #map {
            width: 486px;
            height: 900px;
        }
        .city-point {
            position: absolute;
            width: 12px;
            height: 12px;
            background-color: red;
            border-radius: 50%;
            transform: translate(-50%, -50%);
            cursor: pointer;
        }
        #feedback {
            font-size: 20px;
            font-weight: bold;
            color: red;
        }
    </style>
</head>
<body>

<h2>Ù…Ø±Ø­Ø¨Ù‹Ø§ØŒ {{ player_name }}!</h2>
<h3>Ø§Ø®ØªØ± Ø®Ø±ÙŠØ·Ø© ÙÙ„Ø³Ø·ÙŠÙ†</h3>
<p id="question-text">Ø¬Ø§Ø±Ù ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø³Ø¤Ø§Ù„...</p>

<div id="map-container">
    <img id="map" src="{{ url_for('static', filename='213.png') }}" alt="Ø®Ø±ÙŠØ·Ø© ÙÙ„Ø³Ø·ÙŠÙ†" width="486" height="900">
</div>

<p id="feedback"></p>

<script>
    let correctCity = "";
    let correctCoords = {};

    function loadQuestion() {
        $.get("/get_question", function(data) {
            correctCity = data.city;
            correctCoords = data.coords;
            $("#question-text").text(data.question);
        });
    }

    function addCityPoints() {
        let cities = {
            "Ø§Ù„Ù‚Ø¯Ø³": {x: 282, y: 368},
            "Ø§Ù„Ø®Ù„ÙŠÙ„": {x: 249, y: 428},
            "Ù†Ø§Ø¨Ù„Ø³": {x: 293, y: 259},
            "Ø¬Ù†ÙŠÙ†": {x: 299, y: 207},
            "ØºØ²Ø©": {x: 142, y: 424},
            "ÙŠØ§ÙØ§": {x: 199, y: 313},
            "Ø­ÙŠÙØ§": {x: 237, y: 139},
            "Ø¹ÙƒØ§": {x: 258, y: 113},
            "ØµÙØ¯": {x: 339, y: 98},
            "Ø·Ø¨Ø±ÙŠØ§": {x: 344, y: 153},
            "Ø£Ø±ÙŠØ­Ø§": {x: 325, y: 349},
            "Ø¨Ø¦Ø± Ø§Ù„Ø³Ø¨Ø¹": {x: 198, y: 490},
            "Ø±ÙØ­": {x: 106, y: 477},
            "Ø§Ù„Ù†Ø§ØµØ±Ø©": {x: 297, y: 161}
        };

        for (let city in cities) {
            let coords = cities[city];
            let point = $("<div class='city-point'></div>")
                .css({top: coords.y + "px", left: coords.x + "px"})
                .attr("data-city", city);
            
            $("#map-container").append(point);
        }
    }

    $(document).ready(function() {
        addCityPoints();
        loadQuestion();

        $(document).on("click", ".city-point", function() {
            let selectedCity = $(this).attr("data-city");
            if (selectedCity === correctCity) {
                $("#feedback").text("Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©! ğŸ‰").css("color", "green");
            } else {
                $("#feedback").text("Ø¥Ø¬Ø§Ø¨Ø© Ø®Ø§Ø·Ø¦Ø©ØŒ Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰! âŒ").css("color", "red");
            }
            setTimeout(loadQuestion, 1000);
        });
    });
</script>

</body>
</html>
